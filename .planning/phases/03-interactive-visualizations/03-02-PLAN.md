---
phase: 03-interactive-visualizations
plan: 02
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - src/visualize.py
  - scripts/14_provider_frontier_viz.py
autonomous: true
user_setup: []

must_haves:
  truths:
    - "User can explore Pareto frontier with provider color-coding"
    - "User can compare providers across regions and capabilities"
    - "User can analyze context window scaling by intelligence tier"
  artifacts:
    - path: "src/visualize.py"
      provides: "Additional Plotly utilities"
      min_lines: 150
      exports: ["create_pareto_frontier_chart", "create_provider_comparison", "create_context_window_analysis"]
    - path: "scripts/14_provider_frontier_viz.py"
      provides: "Provider and frontier visualization pipeline"
      min_lines: 400
    - path: "reports/figures/interactive_pareto_frontier.html"
      provides: "Interactive Pareto frontier"
    - path: "reports/figures/interactive_provider_dashboard.html"
      provides: "Interactive provider comparison dashboard"
  key_links:
    - from: "scripts/14_provider_frontier_viz.py"
      to: "data/processed/pareto_frontier.parquet"
      via: "pl.read_ipc() for Pareto flags"
      pattern: "pareto_frontier"
    - from: "scripts/14_provider_frontier_viz.py"
      to: "data/processed/provider_clusters.parquet"
      via: "pl.read_ipc() for provider clusters"
      pattern: "provider_clusters"
    - from: "scripts/14_provider_frontier_viz.py"
      to: "data/processed/ai_models_deduped.parquet"
      via: "pl.read_ipc() for model data"
      pattern: "ai_models_deduped"
---

# Objective

Create interactive visualizations for Pareto frontier analysis, provider comparisons, and context window analysis by intelligence tier.

**Purpose:** Enable exploration of price-performance tradeoffs, provider market segments, and intelligence tier patterns
**Output:** Interactive Pareto frontier chart, provider comparison dashboard, and context window analysis

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@.planning/phases/03-interactive-visualizations/03-01-SUMMARY.md
@data/processed/pareto_frontier.parquet
@data/processed/provider_clusters.parquet
@data/processed/ai_models_deduped.parquet
@src/pareto.py
@src/clustering.py
@src/visualize.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extend visualization utilities for frontier and provider charts</name>
  <files>src/visualize.py</files>
  <action>
    Add to src/visualize.py (extending from Plan 03-01):
    1. create_pareto_frontier_chart(df, x_col, y_col, pareto_col, title, color_col):
       - Scatter plot with Pareto-efficient models highlighted (red markers, larger size)
       - Dominated models shown with transparency (alpha=0.5)
       - Hover shows Model name, Creator, x and y values, Pareto status
       - Annotate top 5 efficient models with text labels
       - Add trend line (lowess smoothing) if n>50
       - Color by provider cluster (if color_col provided) or Creator
    2. create_provider_comparison(provider_df, metrics):
       - 3-panel scatter plot: Intelligence vs Price, Intelligence vs Speed, Price vs Speed
       - Color points by cluster (Budget-Friendly vs Premium Performance)
       - Size points by model_count
       - Hover shows Creator name, cluster, region, and metric values
       - Add cluster centroids with star markers
       - Use facets/subplots for 3-panel layout
    3. create_context_window_analysis(df, tier_col, context_col):
       - Box plot by intelligence tier (Q1, Q2, Q3, Q4)
       - Overlay strip plot with jitter for individual model visualization
       - Hover shows Model name, Creator, context window size, intelligence tier
       - Add annotation for mean and median per tier
       - Use log scale for y-axis if context window range > 1M
    4. All functions return plotly.graph_objects.Figure objects
    5. Apply consistent theme (plotly_white) and readable fonts (size=12)
  </action>
  <verify>
    Run `python -c "from src.visualize import create_pareto_frontier_chart, create_provider_comparison, create_context_window_analysis"` to verify new functions import
  </verify>
  <done>
    3 new visualization functions added to src/visualize.py, all functions importable without errors
  </done>
</task>

<task type="auto">
  <name>Task 2: Execute provider and frontier visualization pipeline</name>
  <files>scripts/14_provider_frontier_viz.py, reports/figures/interactive_*.html</files>
  <action>
    1. Create scripts/14_provider_frontier_viz.py with:
       - Load pareto_frontier.parquet (187 models, 21 columns with Pareto flags)
       - Load provider_clusters.parquet (36 providers, 8 columns)
       - Load ai_models_deduped.parquet for intelligence quartiles
       - Create 2 Pareto frontier charts (VIZ-05):
         * Intelligence vs Price: Highlight is_pareto_intelligence_price models
         * Speed vs Intelligence: Highlight is_pareto_speed_intelligence models
         * Color by Creator, add trend lines, annotate top 5 leaders
       - Create 1 provider comparison dashboard (VIZ-06):
         * 3-panel scatter: Intelligence vs Price, Intelligence vs Speed, Price vs Speed
         * Color by cluster (0=Budget-Friendly, 1=Premium Performance)
         * Size by model_count, hover shows region and metrics
         * Add cluster centroids as star markers
       - Create 1 context window analysis chart (VIZ-08):
         * Box plot of context_window by intelligence tier (Q1-Q4)
         * Strip plot overlay with jitter for individual models
         * Log scale y-axis (context window range: 4K to 10M tokens)
         * Hover shows Model, Creator, tier, context size
       - Save individual HTML files to reports/figures/interactive_*.html
       - Save combined dashboard to reports/figures/interactive_provider_frontier.html
    2. Use intelligence_index (Int64) column for all intelligence-based plots
    3. Filter to n=181 models with valid intelligence for Pareto analysis
    4. Add descriptive statistics to hover (mean, median, quartiles)
    5. Use provider cluster assignments from 02-04 (Budget vs Premium)
    6. Annotate market leaders: GPT-5.2 (dominates all frontiers), Gemini 3 Flash (value leader)
  </action>
  <verify>
    Run `poetry run python scripts/14_provider_frontier_viz.py` and verify:
    - 4 HTML files created (2 Pareto charts, 1 provider dashboard, 1 context window analysis)
    - Combined dashboard created at reports/figures/interactive_provider_frontier.html
    - Open HTML files in browser to confirm Pareto models highlighted correctly
    - Confirm provider clusters colored by Budget vs Premium
    - Verify context window analysis shows log scale
  </verify>
  <done>
    4 interactive visualizations created (2 Pareto frontiers, 1 provider dashboard, 1 context window analysis), all with hover/zoom/pan, combined dashboard generated, VIZ-05, VIZ-06, VIZ-08 satisfied
  </done>
</task>

</tasks>

<verification>
Run verification checks:
1. Open reports/figures/interactive_provider_frontier.html - confirm 4 subplots load
2. Test hover on Intelligence-Price Pareto chart - should show Pareto-efficient models in red
3. Test hover on provider dashboard - should show cluster assignments and region
4. Verify context window box plot uses log scale (check axis labels)
5. Confirm GPT-5.2 annotated as market leader in Pareto charts
6. Verify cluster centroids visible as star markers in provider dashboard
</verification>

<success_criteria>
1. 3 new visualization functions added to src/visualize.py (Pareto, provider, context window)
2. 2 Pareto frontier charts generated (Intelligence-Price, Speed-Intelligence)
3. 1 provider comparison dashboard generated (3-panel scatter with clusters)
4. 1 context window analysis chart generated (box plot by intelligence tier with log scale)
5. All 4 figures saved as HTML files with hover tooltips showing cluster/region/Pareto status
6. Combined dashboard created showing all 4 visualizations
7. VIZ-05 (Pareto frontier), VIZ-06 (provider dashboard), VIZ-08 (context window analysis) satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/03-interactive-visualizations/03-02-SUMMARY.md`
</output>
