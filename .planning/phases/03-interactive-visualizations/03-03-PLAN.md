---
phase: 03-interactive-visualizations
plan: 03
type: execute
wave: 3
depends_on: ["03-01", "03-02"]
files_modified:
  - src/visualize.py
  - scripts/15_linked_brushing_viz.py
autonomous: true
user_setup: []

must_haves:
  truths:
    - "User can explore speed-intelligence tradeoffs with use case zones"
    - "User can filter related visualizations using linked brushing"
    - "All 15 figures pre-generated and saved for notebook loading"
  artifacts:
    - path: "src/visualize.py"
      provides: "Advanced visualization utilities"
      min_lines: 100
      exports: ["create_speed_intelligence_tradeoff", "create_linked_brushing_dashboard"]
    - path: "scripts/15_linked_brushing_viz.py"
      provides: "Linked brushing visualization pipeline"
      min_lines: 350
    - path: "reports/figures/interactive_tradeoff_analysis.html"
      provides: "Interactive speed-intelligence tradeoff chart"
    - path: "reports/figures/interactive_linked_dashboard.html"
      provides: "Linked brushing dashboard"
  key_links:
    - from: "scripts/15_linked_brushing_viz.py"
      to: "data/processed/ai_models_deduped.parquet"
      via: "pl.read_ipc() for model data"
      pattern: "ai_models_deduped"
    - from: "scripts/15_linked_brushing_viz.py"
      to: "reports/figures/interactive_*.html"
      via: "File reading to link existing visualizations"
      pattern: "html"
    - from: "scripts/15_linked_brushing_viz.py"
      to: "src/visualize.py"
      via: "Import all visualization functions"
      pattern: "from src.visualize import"
---

# Objective

Create advanced interactive visualizations including speed-intelligence tradeoff analysis with use case zones and implement linked brushing between related charts.

**Purpose:** Enable cross-filtering and exploration of related visualizations, identify use case zones (real-time vs batch processing)
**Output:** Interactive tradeoff chart with zone annotations, linked brushing dashboard, all figures pre-generated for Phase 4 notebook

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@.planning/phases/03-interactive-visualizations/03-01-SUMMARY.md
@.planning/phases/03-interactive-visualizations/03-02-SUMMARY.md
@data/processed/ai_models_deduped.parquet
@src/visualize.py
@scripts/13_distribution_viz.py
@scripts/14_provider_frontier_viz.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Implement speed-intelligence tradeoff and linked brushing utilities</name>
  <files>src/visualize.py</files>
  <action>
    Add to src/visualize.py (extending from Plans 03-01 and 03-02):
    1. create_speed_intelligence_tradeoff(df, x_col, y_col, title):
       - Scatter plot with Speed (x-axis) vs Intelligence (y-axis)
       - Define use case zones with rectangular shapes:
         * Real-time Zone: Speed > 100 tokens/s (low latency focus)
         * High-IQ Zone: Intelligence > 40 (complex reasoning)
         * Balanced Zone: Speed 50-100 AND Intelligence 20-40
         * Budget Zone: Speed < 50 AND Intelligence < 20
       - Color points by zone (4 distinct colors)
       - Hover shows Model name, Creator, zone, Speed, Intelligence
       - Add zone labels as text annotations
       - Mark Pareto-efficient models (is_pareto_speed_intelligence) with star markers
    2. create_linked_brushing_dashboard(df, figures_dict):
       - Create Plotly Dash-style layout using plotly.subplots
       - Link 4 related visualizations:
         * Intelligence histogram (top-left)
         * Price histogram (top-right)
         * Speed vs Intelligence scatter (bottom-left)
         * Price vs Intelligence scatter (bottom-right)
       - Implement cross-filtering:
         * Clicking a bar in histogram filters scatter plots to that range
         * Clicking a point in scatter highlights that model in all plots
         * Use plotly.callbacks for custom JavaScript interactivity
       - Add selection dropdown to filter by provider cluster (Budget vs Premium)
       - Add reset button to clear all filters
       - Save as self-contained HTML with embedded JavaScript
    3. Both functions return plotly.graph_objects.Figure objects
    4. Apply consistent theme (plotly_white) and readable fonts
  </action>
  <verify>
    Run `python -c "from src.visualize import create_speed_intelligence_tradeoff, create_linked_brushing_dashboard"` to verify new functions import
  </verify>
  <done>
    2 new visualization functions added to src/visualize.py, linked brushing utility supports cross-filtering across 4 plots
  </done>
</task>

<task type="auto">
  <name>Task 2: Execute tradeoff analysis and linked brushing pipeline</name>
  <files>scripts/15_linked_brushing_viz.py, reports/figures/interactive_*.html</files>
  <action>
    1. Create scripts/15_linked_brushing_viz.py with:
       - Load ai_models_deduped.parquet (187 models, 18 columns)
       - Merge with provider_clusters.parquet for cluster assignments (by Creator)
       - Create 1 speed-intelligence tradeoff chart (VIZ-07):
         * Scatter plot: Speed (x) vs Intelligence (y)
         * Define 4 use case zones with rectangular overlays:
           - Real-time: Speed > 100, any Intelligence (green zone)
           - High-IQ: Intelligence > 40, any Speed (blue zone)
           - Balanced: 50 <= Speed <= 100 AND 20 <= Intelligence <= 40 (yellow zone)
           - Budget: Speed < 50 AND Intelligence < 20 (gray zone)
         * Color points by zone, add zone labels
         * Mark Pareto-efficient models (is_pareto_speed_intelligence) with stars
         * Hover shows Model, Creator, zone, Speed, Intelligence
         * Add legend explaining use cases
       - Create 1 linked brushing dashboard (VIZ-10):
         * 4-panel layout: Intelligence histogram, Price histogram, Speed-IQ scatter, Price-IQ scatter
         * Implement cross-filtering with JavaScript callbacks:
           - Select intelligence range in histogram → filter scatter plots
           - Click model in scatter → highlight in all plots
           - Dropdown for provider cluster filter (All/Budget/Premium)
           - Reset button to clear filters
         * Use plotly.subplots.make_subplots for 2x2 layout
         * Embed custom JavaScript for selection linkage
         * Save as self-contained HTML (no external dependencies)
       - Create master index file: reports/figures/all_visualizations.html
         * Links to all 15 interactive visualizations from Plans 01, 02, 03
         * Organized by category: Distributions (6), Provider/Frontier (4), Advanced (2)
         * Brief description of each visualization
         * Open all links in new tab
    2. Use intelligence_index (Int64) column, filter to n=181 models with valid IQ
    3. Use Speed column (cast String to Float64 if needed)
    4. Merge cluster assignments from provider_clusters.parquet (join on Creator)
    5. Add zone annotations with semi-transparent rectangles (alpha=0.2)
    6. Test linked brushing in browser (confirm clicking filters update all plots)
  </action>
  <verify>
    Run `poetry run python scripts/15_linked_brushing_viz.py` and verify:
    - 3 HTML files created (tradeoff chart, linked dashboard, master index)
    - Open interactive_tradeoff_analysis.html - confirm 4 zones visible with labels
    - Open interactive_linked_dashboard.html - test clicking intelligence histogram bar filters scatter plots
    - Open all_visualizations.html - confirm links to all 15 visualizations work
    - Test Pareto-efficient models marked with stars in tradeoff chart
  </verify>
  <done>
    2 interactive visualizations created (tradeoff chart with zones, linked brushing dashboard), master index file created, all 15 figures pre-generated for Phase 4, VIZ-03 (scatter plots), VIZ-07 (tradeoff), VIZ-09 (hover/zoom/pan), VIZ-10 (linked brushing), VIZ-11 (pre-generated) satisfied
  </done>
</task>

</tasks>

<verification>
Run verification checks:
1. Open reports/figures/interactive_tradeoff_analysis.html - confirm 4 zones visible
2. Hover over different zones - should show use case labels (Real-time, High-IQ, Balanced, Budget)
3. Verify Pareto-efficient models marked with star markers
4. Open reports/figures/interactive_linked_dashboard.html - test linked brushing:
   - Click intelligence histogram bar (e.g., IQ 20-30) - confirm scatter plots filter
   - Click a point in Speed-IQ scatter - confirm model highlighted in all plots
   - Test provider cluster dropdown (select "Premium" - confirm budget providers filtered)
   - Click "Reset Filters" - confirm all plots reset to full data
5. Open reports/figures/all_visualizations.html - confirm links to all 15 visualizations
6. Verify all HTML files are self-contained (no external dependencies)
</verification>

<success_criteria>
1. 2 new visualization functions added to src/visualize.py (tradeoff, linked brushing)
2. 1 speed-intelligence tradeoff chart generated with 4 use case zones
3. 1 linked brushing dashboard generated with 4-panel cross-filtering
4. 1 master index file created linking all 15 visualizations
5. Tradeoff chart shows zone annotations (Real-time, High-IQ, Balanced, Budget)
6. Linked brushing enables cross-filtering (histogram selection filters scatter plots)
7. All 15 figures pre-generated and saved as HTML files for Phase 4 notebook
8. VIZ-03 (scatter plots), VIZ-07 (tradeoff zones), VIZ-09 (hover/zoom/pan on all charts), VIZ-10 (linked brushing), VIZ-11 (pre-generated) satisfied
9. Phase 3 complete: All 11 visualization requirements (VIZ-01 through VIZ-11) satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/03-interactive-visualizations/03-03-SUMMARY.md`
</output>
